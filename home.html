<html>
<head>
	<link rel="stylesheet" href="home.css">
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body class="parallax-bg">
	<div class="page-divs" style="background-color:black; text-align:center; color:white; font-size:40px" > Fissionary </div>
	<div class="page-divs" style="background-color:black; height:80%; text-align:center; color:white; font-size:30px" >
		<div>
			Locations Near You
		</div>
		<p />
		<div id="container" >
			<div id="map" style="float:left; height:80%; width:49%; border:1px solid white"> Map </div>
			<div id="listDiv" style="float:right; width:49%; "> 
			List of Locations Near You <br />
			</div>
		</div>
	</div>
	<script type="text/javascript">
		var sampleJSON = "{\"locations\":[{\"locationId\":1,\"locationName\":\"WoonderLa\"},{\"locationId\":2,\"locationName\":\"Essel World\"}]}";		
		function showLocationList()
		{
			/*if(xhr.readyState==4 && xhr.status==200)
			{
				var theList = JSON.parse(xhr.responseText); */
				//var sampleJSON = "{\"locations\":[{\"locationId\":1,\"locationName\":\"WoonderLa\"},{\"locationId\":2,\"locationName\":\"Essel World\"}]}";
				var theList = JSON.parse(sampleJSON);
				console.log(theList);
				
				var listDiv = document.getElementById("listDiv");
				
				//MAP PART FROM VIDYA
				
				var listHtml = document.createElement("p");
				for (var i=0; i<theList.locations.length; i++) //Check what is to be iterated with JSON; CHECK
				{
					li = document.createElement("p");
					a = document.createElement("a");
					li.appendChild(a);
					a.innerHTML = theList.locations[i].locationName; //Check locationName with JSON; CHECK
					a.href = "location.html?lid="+theList.locations[i].locationId; //Check locationId with JSON; CHECK
					listHtml.appendChild(li);
				}
				listDiv.appendChild(listHtml);
			//}
		}
		
		/*xhr = new XMLHttpRequest();
		xhr.open("GET","http://localhost:5000/locations",true);
		xhr.onreadystatechange=showLocationList;
		xhr.send(); */
		
		showLocationList();		
		
	
      function initMap() {	
					handle_geolocation_query(sampleJSON);
		
		}
	  function handle_geolocation_query(str_json)
	  {
		//console.log("hey");
		//console.log(typeof config_json);
		//console.log(config_json[0]);
		//console.log(JSON.parse(config_json));
		config_json = JSON.parse(str_json)
		//console.log(config_json);
		console.log(config_json['locations']);
		for(var key in config_json['locations'])
			console.log(key);
			for (var key in config_json['locations']) {
				if (config_json['locations'].hasOwnProperty(key)) {
				console.log(key + " -> " + config_json['locations'][key]);
				for (var key1 in config_json['locations'][key]){
					console.log(key1);
					console.log(config_json['locations'][key][key1]);
					}
			}
			}
		for(i=0;i<1;i++)
		{
			//var address = config_json[i]['locationName'];
			/*var _lat =0;
			var _lng = 0;
        	geocoder = new google.maps.Geocoder();
        	geocoder.geocode(
			{
				'address': config_json[i]['locationName']
			},
			function(results, status) 
			{                      
				_lat = results[0].geometry.location.lat();
				_lng = results[0].geometry.location.lng();
				//console.log("inside function " + _lat + "::"+_lng+"::"+parseInt(config_json[i]['map_zoom']));			
				var uluru = {lat: _lat, lng: _lng};
				var map = new google.maps.Map(document.getElementById('map'), {  zoom: 17, center:uluru     });
				var marker = new google.maps.Marker(
				{
					position: uluru,
					map: map
				});
				
			});*/
			//console.log(address);
	
      }
	  }
	  
	  
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB-1PozKHxTwZPlZmj9ius6615N7ksfM_8&callback=initMap">
    </script>
</body>
</html>
